
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Full installation instructions &#8212; GROMACS External Interfaces</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using the Python package" href="usage.html" />
    <link rel="prev" title="Python User Guide" href="userguide.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Using the Python package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="userguide.html" title="Python User Guide"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">gmxapi</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="userguide.html" accesskey="U">Python User Guide</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="full-installation-instructions">
<h1>Full installation instructions<a class="headerlink" href="#full-installation-instructions" title="Permalink to this headline">¶</a></h1>
<p>This document provides detailed documentation about building and installing
the gmxapi Python package.</p>
<p>GROMACS is a high performance computational science tool that is optimized for
a variety of specialized hardware and parallel computing environments.
To make the best use of a computing environment, GROMACS is usually built from
source code.</p>
<p>Users of Python based molecular science tools may have various requirements and
use a variety of Python distributions,
so gmxapi extension code is most useful when built from source code for a specific
GROMACS installation and Python environment.</p>
<p>This document has a lot of detail.
If you don’t need a lot of reference material, you may just jump ahead to the <a class="reference internal" href="#installation"><span class="std std-ref">Recommended installation</span></a>.</p>
<p>Command line examples assume the <a class="reference external" href="https://www.gnu.org/software/bash/">bash</a> shell.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Regarding multiple GROMACS installations:
Many GROMACS users switch between multiple GROMACS installations on the same
computer using an HPC module system and/or a GMXRC configuration script.
For the equivalent sort of environment switching with the <code class="docutils literal notranslate"><span class="pre">gmxapi</span></code> Python package,
we recommend installing it in a different
<a class="reference external" href="https://www.google.com/search?q=python+virtual+environment">Python virtual environment</a>
for each GROMACS installation.
Once built, a particular copy of the <code class="docutils literal notranslate"><span class="pre">gmxapi</span></code> Python package always refers to the
same GROMACS installation.</p>
</div>
<div class="contents local topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#requirements" id="id8">Requirements</a></p>
<ul>
<li><p><a class="reference internal" href="#build-system-requirements" id="id9">Build system requirements</a></p></li>
<li><p><a class="reference internal" href="#python-environment-requirements" id="id10">Python environment requirements</a></p></li>
<li><p><a class="reference internal" href="#documentation-build-requirements" id="id11">Documentation build requirements</a></p></li>
<li><p><a class="reference internal" href="#testing-requirements" id="id12">Testing requirements</a></p></li>
<li><p><a class="reference internal" href="#mpi-requirements" id="id13">MPI requirements</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#installing-the-python-package" id="id14">Installing the Python package</a></p>
<ul>
<li><p><a class="reference internal" href="#recommended-installation" id="id15">Recommended installation</a></p></li>
<li><p><a class="reference internal" href="#install-from-source" id="id16">Install from source</a></p></li>
<li><p><a class="reference internal" href="#offline-install" id="id17">Offline install</a></p></li>
<li><p><a class="reference internal" href="#building-a-source-archive" id="id18">Building a source archive</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#accessing-gmxapi-documentation" id="id19">Accessing gmxapi documentation</a></p>
<ul>
<li><p><a class="reference internal" href="#build-with-gromacs" id="id20">Build with GROMACS</a></p></li>
<li><p><a class="reference internal" href="#docker-web-server" id="id21">Docker web server</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#troubleshooting" id="id22">Troubleshooting</a></p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following documentation contains frequent references to the <code class="docutils literal notranslate"><span class="pre">pip</span></code> tool
for installing Python packages. In some cases, an unprivileged user should
use the <code class="docutils literal notranslate"><span class="pre">--user</span></code> command line flag to tell <code class="docutils literal notranslate"><span class="pre">pip</span></code> to install packages
into the user site-packages directory rather than the default site-packages
directory for the Python installation. This flag is not appropriate when
running <code class="docutils literal notranslate"><span class="pre">pip</span></code> in a virtual environment (as recommended) and is omitted in
this documentation. If you need the <code class="docutils literal notranslate"><span class="pre">--user</span></code> flag, you should modify the
example commands to look something like <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--upgrade</span> <span class="pre">somepackage</span> <span class="pre">--user</span></code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These instructions use the executable names <code class="docutils literal notranslate"><span class="pre">python</span></code> and <code class="docutils literal notranslate"><span class="pre">pip</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">python3</span></code> or <code class="docutils literal notranslate"><span class="pre">pip3</span></code>. Some Python installations require the <code class="docutils literal notranslate"><span class="pre">3</span></code>
suffix, but it is usually not necessary if you have already activated a Python
virtual environment (recommended).</p>
</div>
<div class="section" id="requirements">
<h2><a class="toc-backref" href="#id8">Requirements</a><a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">gmxapi</span></code> comes in three parts:</p>
<ul class="simple">
<li><p>GROMACS gmxapi library for C++.</p></li>
<li><p>This Python package, supporting Python 3.5 and higher</p></li>
<li><p>MD restraint plugins and sample gmxapi client code</p></li>
</ul>
<div class="section" id="build-system-requirements">
<h3><a class="toc-backref" href="#id9">Build system requirements</a><a class="headerlink" href="#build-system-requirements" title="Permalink to this headline">¶</a></h3>
<p>gmxapi can be built for Python 3.5 and higher.</p>
<p>You will need a C++ 14 compatible compiler and a reasonably up-to-date version
of CMake.
Full gmxapi functionality may also require an MPI compiler (e.g. <code class="docutils literal notranslate"><span class="pre">mpicc</span></code>).</p>
<p>The Python package requires a GROMACS installation.
Build and install
<a class="reference external" href="http://manual.gromacs.org/documentation/current/install-guide/index.html">GROMACS</a>
before proceeding. Be sure to configure CMake with the <code class="docutils literal notranslate"><span class="pre">GMXAPI=ON</span></code> option.</p>
<p>Then, “source” the GMXRC file from the GROMACS installation as you normally would
before using GROMACS, or note its installation location so that you can pass it
to the build configuration.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using a managed computing resource, such as a research HPC cluster,
GROMACS may already be installed, but you will need GROMACS 2020 or later, and
it must be configured with <code class="docutils literal notranslate"><span class="pre">GMXAPI=ON</span></code>.</p>
</div>
<p>Important: To build a module that can be imported by Python, you need a Python
installation that includes the Python headers. Unfortunately, it is not always
obvious whether these headers are present or where to find them. The simplest
answer is to just try to build the Python package using these instructions, and
if gmxapi is unable to find the Python tools it needs, try a different Python
installation or install the additional development packages.</p>
<p>On a Linux system, this may require installing packages such as <code class="docutils literal notranslate"><span class="pre">python-dev</span></code>
and/or <code class="docutils literal notranslate"><span class="pre">python3-dev</span></code>.
If you are building Python, either from scratch or with a tool like
<code class="docutils literal notranslate"><span class="pre">pyenv</span> <span class="pre">install</span></code> (see
<a class="reference external" href="https://github.com/pyenv/pyenv/wiki#how-to-build-cpython-with---enable-shared">wiki entry</a>
),
be sure to enable installation of the Python C library with the
<code class="docutils literal notranslate"><span class="pre">--enable-shared</span></code> flag.
Alternatively, various Python distributions provide a
sufficient build environment while only requiring installation into a user
home directory. (Some examples below.)</p>
<p>If you are using an HPC system with software available through modules you may
be able to just <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span></code> a different Python installation and find one
that works.</p>
</div>
<div class="section" id="python-environment-requirements">
<h3><a class="toc-backref" href="#id10">Python environment requirements</a><a class="headerlink" href="#python-environment-requirements" title="Permalink to this headline">¶</a></h3>
<p>gmxapi requires Python 3.5 or higher. Check your version with
<code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">--version</span></code> or <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">--version</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following documentation assumes you do not need to use a trailing ‘3’ to
access a Python 3 interpreter on your system.
The default Python interpreter on your system may use <code class="docutils literal notranslate"><span class="pre">python3</span></code> and <code class="docutils literal notranslate"><span class="pre">pip3</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">python</span></code> and <code class="docutils literal notranslate"><span class="pre">pip</span></code>. You can check the version with
<code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">--version</span></code> or <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">--version</span></code> and <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">--version</span></code>.</p>
</div>
<p>To build and install, you also need the packages <code class="docutils literal notranslate"><span class="pre">cmake</span></code>,
<code class="docutils literal notranslate"><span class="pre">setuptools</span></code>, <code class="docutils literal notranslate"><span class="pre">networkx</span></code>, and <code class="docutils literal notranslate"><span class="pre">scikit-build</span></code>.</p>
<p>For full functionality, you should also have <code class="docutils literal notranslate"><span class="pre">mpi4py</span></code> and <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.
These requirements and version numbers are listed in <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code>.</p>
<p>The easiest way to make sure you have the requirements installed, first update
<code class="docutils literal notranslate"><span class="pre">pip</span></code>, then use the <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file provided with the repository.
File paths in this section are relative to the root directory of your local copy
of the GROMACS source.</p>
<p>Confirm that <code class="docutils literal notranslate"><span class="pre">pip</span></code> is available, install <code class="docutils literal notranslate"><span class="pre">pip</span></code> if it is missing, or get
instructions on how to install <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m ensurepip --default-pip
</pre></div>
</div>
<p>Install or upgrade required components:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m pip install --upgrade pip
pip install --upgrade setuptools
</pre></div>
</div>
<div class="section" id="requirements-files-in-gromacs-source-tree">
<h4>“requirements” files in GROMACS source tree<a class="headerlink" href="#requirements-files-in-gromacs-source-tree" title="Permalink to this headline">¶</a></h4>
<p>If you are building from source code in a local copy of the GROMACS source
repository, some helpful files allow you to preinstall the Python requirements
before installing the <code class="docutils literal notranslate"><span class="pre">gmxapi</span></code> package.</p>
<blockquote>
<div><p>pip install -r python_packaging/src/requirements.txt</p>
</div></blockquote>
<p>If building documentation or running tests,
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">python_packaging/requirements-docs.txt</span></code> or
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">python_packaging/requirements-test.txt</span></code>,
respectively, or see below.</p>
</div>
</div>
<div class="section" id="documentation-build-requirements">
<h3><a class="toc-backref" href="#id11">Documentation build requirements</a><a class="headerlink" href="#documentation-build-requirements" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="#gmxapi-package-documentation"><span class="std std-ref">Accessing gmxapi documentation</span></a></p>
</div>
<div class="section" id="testing-requirements">
<span id="id1"></span><h3><a class="toc-backref" href="#id12">Testing requirements</a><a class="headerlink" href="#testing-requirements" title="Permalink to this headline">¶</a></h3>
<p>Testing is performed with <a class="reference external" href="https://docs.pytest.org/en/latest/">pytest</a>.
Tests also require <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.
You can probably install both with <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install pytest numpy
</pre></div>
</div>
<p>To test the full functionality also requires an MPI parallel environment.
You will need the <code class="docutils literal notranslate"><span class="pre">mpi4py</span></code> Python package and an MPI launcher
(such as <code class="docutils literal notranslate"><span class="pre">mpiexec</span></code>, <code class="docutils literal notranslate"><span class="pre">mpirun</span></code>, a launcher provided by your HPC queuing system,
or whatever is provided by your favorite MPI package for your operating system).</p>
</div>
<div class="section" id="mpi-requirements">
<span id="id2"></span><h3><a class="toc-backref" href="#id13">MPI requirements</a><a class="headerlink" href="#mpi-requirements" title="Permalink to this headline">¶</a></h3>
<p>For the ensemble simulations features, you will need an MPI installation. On an HPC system, this means you will
probably have to use <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span></code> to load a compatible set of MPI tools and compilers. Check your HPC
documentation or try <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">avail</span></code> to look for an <code class="docutils literal notranslate"><span class="pre">openmpi</span></code>, <code class="docutils literal notranslate"><span class="pre">mpich</span></code>, or <code class="docutils literal notranslate"><span class="pre">mvapich</span></code> module and matching compiler
module. This may be as simple as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>module load gcc
module load mpicc
</pre></div>
</div>
<p>Note that the compilers loaded might not be the first compilers discovered automatically by the build tools we will use
below, so you may have to specify compilers on the command line for consistency. It may be necessary to require that
GROMACS, gmxapi, and the sample code are built with the same compiler(s).</p>
<p>Note that strange errors have been known to occur when <code class="docutils literal notranslate"><span class="pre">mpi4py</span></code> is built with
different a different tool set than has been used to build Python and gmxapi.
If the default compilers on your system are not sufficient for GROMACS or gmxapi,
you may need to build, e.g., OpenMPI or MPICH, and/or build <code class="docutils literal notranslate"><span class="pre">mpi4py</span></code> with a
specific MPI compiler wrapper. This can complicate building in environments such
as Conda.</p>
<p>Set the MPICC environment variable to the MPI compiler wrapper and forcibly
reinstall <code class="docutils literal notranslate"><span class="pre">mpi4py</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">MPICC</span><span class="o">=</span><span class="sb">`</span>which mpicc<span class="sb">`</span>
pip install --no-cache-dir --upgrade --no-binary <span class="se">\&quot;</span>:all:<span class="se">\&quot;</span> --force-reinstall mpi4py
</pre></div>
</div>
</div>
</div>
<div class="section" id="installing-the-python-package">
<h2><a class="toc-backref" href="#id14">Installing the Python package</a><a class="headerlink" href="#installing-the-python-package" title="Permalink to this headline">¶</a></h2>
<p>We recommend you install the gmxapi package in a Python virtual environment
(<code class="docutils literal notranslate"><span class="pre">virtualenv</span></code> or <code class="docutils literal notranslate"><span class="pre">venv</span></code>). There are several ways to do this, and it is also
possible to install without a virtual environment. If installing without a
virtual environment as an un-privileged user, you may need to set the CMake
variable <code class="docutils literal notranslate"><span class="pre">GMXAPI_USER_INSTALL</span></code> (<code class="docutils literal notranslate"><span class="pre">-DGMXAPI_USER_INSTALL=ON</span></code> on the <code class="docutils literal notranslate"><span class="pre">cmake</span></code>
command line) and / or use the <code class="docutils literal notranslate"><span class="pre">--user</span></code> option with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code>.</p>
<p>Sometimes the build environment can choose a different Python interpreter than
the one you intended.
You can set the <code class="docutils literal notranslate"><span class="pre">PYTHON_EXECUTABLE</span></code> CMake variable to explicitly choose the
Python interpreter for your chosen installation.
For example: <code class="docutils literal notranslate"><span class="pre">-DPYTHON_EXECUTABLE=\`which</span> <span class="pre">python\`</span></code></p>
<div class="section" id="recommended-installation">
<span id="installation"></span><h3><a class="toc-backref" href="#id15">Recommended installation</a><a class="headerlink" href="#recommended-installation" title="Permalink to this headline">¶</a></h3>
<p>We recommend using Python’s <a class="reference external" href="https://pip.pypa.io/en/stable/">pip</a>
package installer to automatically download, build, and install the latest
version of the gmxapi package into a Python
<a class="reference external" href="https://docs.python.org/3/tutorial/venv.html">virtual environment</a>.
gmxapi requires an existing GROMACS installation.</p>
<p>The instructions in this section assume that <em>pip</em> is able to download files
from the internet.</p>
<div class="section" id="locate-or-install-gromacs">
<h4>Locate or install GROMACS<a class="headerlink" href="#locate-or-install-gromacs" title="Permalink to this headline">¶</a></h4>
<p>You need a GROMACS installation that includes the gmxapi headers and library.
If GROMACS 2020 or higher is already installed,
<em>and</em> was configured with <code class="docutils literal notranslate"><span class="pre">GMXAPI=ON</span></code> at build time,
you can just source the GMXRC
(so that the Python package knows where to find GROMACS)
and skip to the next section.</p>
<p>Otherwise, install a supported version of GROMACS.
When building GROMACS from source, be sure to configure cmake with the flag
<code class="docutils literal notranslate"><span class="pre">-DGMXAPI=ON</span></code> (default).</p>
<p>Set the environment variables for the GROMACS installation so that the gmxapi
headers and library can be found when building the Python package.
If you installed to a <code class="docutils literal notranslate"><span class="pre">gromacs-gmxapi</span></code> directory in your home directory as
above and you use the <code class="docutils literal notranslate"><span class="pre">bash</span></code> shell, do:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> <span class="nv">$HOME</span>/gromacs-gmxapi/bin/GMXRC
</pre></div>
</div>
</div>
<div class="section" id="set-up-a-python-virtual-environment">
<span id="gmxapi-venv"></span><h4>Set up a Python virtual environment<a class="headerlink" href="#set-up-a-python-virtual-environment" title="Permalink to this headline">¶</a></h4>
<p>We recommend installing the Python package in a virtual environment.
If not installing in a virtual environment, you may not be able to install
necessary prerequisites (e.g. if you are not an administrator of the system you are on).</p>
<p>Create a Python 3 virtual environment.</p>
<p>For Python 3, use the <code class="docutils literal notranslate"><span class="pre">venv</span></code> module.
Depending on your computing environment, the Python 3 interpreter may be accessed
with the command <code class="docutils literal notranslate"><span class="pre">python</span></code> or <code class="docutils literal notranslate"><span class="pre">python3</span></code>. Use <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">--version</span></code> and
<code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">--version</span></code> to figure out which you need to use. The following assumes
the Python 3 interpreter is accessed with <code class="docutils literal notranslate"><span class="pre">python3</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After activating the venv, <code class="docutils literal notranslate"><span class="pre">python</span></code> and <code class="docutils literal notranslate"><span class="pre">pip</span></code> are sufficient. (The ‘3’
suffix will no longer be necessary and will be omitted in the rest of this
document.)</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3 -m venv <span class="nv">$HOME</span>/myvenv
</pre></div>
</div>
<p>Activate the virtual environment. Your shell prompt will probably be updated with the name of the environment you
created to make it more obvious.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ source $HOME/myvenv/bin/activate
(myvenv)$
</pre></div>
</div>
<p>Activating the virtual environment changes your shell prompt to indicate the
environment is active. The prompt is omitted from the remainging examples, but
the remaining examples assume the virtualenv is still active.
(Don’t do it now, but you can deactivate the environment by running <code class="docutils literal notranslate"><span class="pre">deactivate</span></code>.)</p>
</div>
<div class="section" id="install-dependencies">
<h4>Install dependencies<a class="headerlink" href="#install-dependencies" title="Permalink to this headline">¶</a></h4>
<p>It is always a good idea to update <code class="docutils literal notranslate"><span class="pre">pip</span></code> and <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> before installing
new Python packages:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install --upgrade pip setuptools
</pre></div>
</div>
<p>The gmxapi installer requires a few additional packages. It is best to make sure
they are installed and up to date before proceeding.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install --upgrade cmake scikit-build
</pre></div>
</div>
<p>For MPI, we use mpi4py.
Make sure it is using the same MPI installation that we are building
GROMACS against and building with compatible compilers.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m pip install --upgrade pip setuptools
<span class="nv">MPICC</span><span class="o">=</span><span class="sb">`</span>which mpicc<span class="sb">`</span> pip install --upgrade mpi4py
</pre></div>
</div>
</div>
<div class="section" id="install-the-latest-version-of-gmxapi">
<h4>Install the latest version of gmxapi<a class="headerlink" href="#install-the-latest-version-of-gmxapi" title="Permalink to this headline">¶</a></h4>
<p>Fetch and install the latest version of gmxapi from the Python Packaging Index:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install gmxapi
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">pip</span></code> does not find your GROMACS installation, use one of the following
environment variables to provide a hint.</p>
<div class="section" id="gmxapi-dir">
<h5>gmxapi_DIR<a class="headerlink" href="#gmxapi-dir" title="Permalink to this headline">¶</a></h5>
<p>If you have a single GROMACS installation at <code class="docutils literal notranslate"><span class="pre">/path/to/gromacs</span></code>, it is usually
sufficient to provide this location to <code class="docutils literal notranslate"><span class="pre">pip</span></code> through the <code class="docutils literal notranslate"><span class="pre">gmxapi_DIR</span></code>
environment variable.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">gmxapi_DIR</span><span class="o">=</span>/path/to/gromacs pip install gmxapi
</pre></div>
</div>
</div>
<div class="section" id="gmxtoolchaindir">
<h5>GMXTOOLCHAINDIR<a class="headerlink" href="#gmxtoolchaindir" title="Permalink to this headline">¶</a></h5>
<p>If you have multiple builds of GROMACS distinguished by suffixes
(e.g. <em>_d</em>, <em>_mpi</em>, etcetera), or if you need to provide extra hints to <code class="docutils literal notranslate"><span class="pre">pip</span></code>
about the software tools that were used to build GROMACS, you can specify a
directory in which the installer can find a CMake “tool chain”.</p>
<p>In the following example, <code class="docutils literal notranslate"><span class="pre">${SUFFIX}</span></code> is the suffix that distinguishes the
particular build of GROMACS you want to target (refer to GROMACS installation
instructions for more information.) <code class="docutils literal notranslate"><span class="pre">${SUFFIX}</span></code> may simply be empty, or <code class="docutils literal notranslate"><span class="pre">''</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">GMXTOOLCHAINDIR</span><span class="o">=</span>/path/to/gromacs/share/cmake/gromacs<span class="si">${</span><span class="nv">SUFFIX</span><span class="si">}</span> pip install gmxapi
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="install-from-source">
<h3><a class="toc-backref" href="#id16">Install from source</a><a class="headerlink" href="#install-from-source" title="Permalink to this headline">¶</a></h3>
<p>You can also install the <code class="docutils literal notranslate"><span class="pre">gmxapi</span></code> Python package from within a local copy of
the GROMACS source repository. Assuming you have already obtained the GROMACS
source code and you are in the root directory of the source tree, you will find
the <code class="docutils literal notranslate"><span class="pre">gmxapi</span></code> Python package sources in the <code class="docutils literal notranslate"><span class="pre">python_packaging/src</span></code> directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> python_packaging/src
pip install -r requirements.txt
pip install .
</pre></div>
</div>
</div>
<div class="section" id="offline-install">
<h3><a class="toc-backref" href="#id17">Offline install</a><a class="headerlink" href="#offline-install" title="Permalink to this headline">¶</a></h3>
<p>If the required dependencies are already installed, you can do a quick installation
without internet access, either from the source directory or from a source archive.</p>
<p>For example, the last line of the previous example could be replaced with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install --no-cache-dir --no-deps --no-index --no-build-isolation .
</pre></div>
</div>
<p>Refer to <code class="docutils literal notranslate"><span class="pre">pip</span></code> documentation for descriptions of these options.</p>
<p>If you have built or downloaded a source distribution archive, you can provide
the archive file to <code class="docutils literal notranslate"><span class="pre">pip</span></code> instead of the <code class="docutils literal notranslate"><span class="pre">.</span></code> argument:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install gmxapi-0.1.0.tar.gz
</pre></div>
</div>
<p>In this example, the archive file name is as was downloaded from
<a class="reference external" href="https://pypi.org/project/gmxapi/#history">PyPI</a> or as built locally,
according to the following instructions.</p>
</div>
<div class="section" id="building-a-source-archive">
<h3><a class="toc-backref" href="#id18">Building a source archive</a><a class="headerlink" href="#building-a-source-archive" title="Permalink to this headline">¶</a></h3>
<p>A source archive for the gmxapi python package can be built from the GROMACS
source repository using Python <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> and <code class="docutils literal notranslate"><span class="pre">scikit-build</span></code>.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install --upgrade setuptools scikit-build
<span class="nb">cd</span> python_packaging/src
python setup.py sdist
</pre></div>
</div>
<p>This command will create a <code class="docutils literal notranslate"><span class="pre">dist</span></code> directory containing a source distribution
archive file. The file name has the form <em>gmxapi-&lt;version&gt;.&lt;suffix&gt;</em>, where
<em>&lt;version&gt;</em> is the version from the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file, and <em>&lt;suffix&gt;</em> is
determined by the local environment or by additional arguments to <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Python documentation for
<a class="reference external" href="https://docs.python.org/3/distutils/sourcedist.html#creating-a-source-distribution">creating a source distribution</a></p>
</div>
<p>Package maintainers may update the online respository by uploading a freshly
built <code class="docutils literal notranslate"><span class="pre">sdist</span></code> with <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">twine</span> <span class="pre">upload</span> <span class="pre">dist/*</span></code></p>
</div>
</div>
<div class="section" id="accessing-gmxapi-documentation">
<span id="gmxapi-package-documentation"></span><h2><a class="toc-backref" href="#id19">Accessing gmxapi documentation</a><a class="headerlink" href="#accessing-gmxapi-documentation" title="Permalink to this headline">¶</a></h2>
<p>Documentation for the Python classes and functions in the gmx module can
be accessed in the usual ways, using <code class="docutils literal notranslate"><span class="pre">pydoc</span></code> from the command line or
<code class="docutils literal notranslate"><span class="pre">help()</span></code> in an interactive Python session.</p>
<p>The complete documentation (which you are currently reading)
can be browsed <a class="reference external" href="http://gmxapi.org/">online</a>
or built from a copy of the GROMACS source repository.</p>
<div class="admonition-todo admonition" id="id5">
<p class="admonition-title">Todo</p>
<p><a href="#id3"><span class="problematic" id="id4">:issue:`2985`</span></a> Replace reference URL with <a class="reference external" href="http://manual.gromacs.org/current/gmxapi/">http://manual.gromacs.org/current/gmxapi/</a></p>
</div>
<p>Documentation is built from a combination of Python module documentation and
static content, and requires a local copy of the GROMACS source repository.</p>
<div class="section" id="build-with-gromacs">
<h3><a class="toc-backref" href="#id20">Build with GROMACS</a><a class="headerlink" href="#build-with-gromacs" title="Permalink to this headline">¶</a></h3>
<p>To build the full gmxapi documentation with GROMACS, configure GROMACS with
<code class="docutils literal notranslate"><span class="pre">-DGMX_PYTHON_PACKAGE=ON</span></code> and build the GROMACS documentation normally.</p>
</div>
<div class="section" id="docker-web-server">
<h3><a class="toc-backref" href="#id21">Docker web server</a><a class="headerlink" href="#docker-web-server" title="Permalink to this headline">¶</a></h3>
<p>Alternatively, build the <code class="docutils literal notranslate"><span class="pre">docs</span></code> Docker image from <code class="docutils literal notranslate"><span class="pre">python_packaging/docker/docs.dockerfile</span></code>
or pull a prebuilt image from DockerHub. Refer to the dockerfile or to
<a class="reference external" href="https://hub.docker.com/r/gmxapi/docs">https://hub.docker.com/r/gmxapi/docs</a> for more information.</p>
<div class="admonition-todo admonition" id="id7">
<p class="admonition-title">Todo</p>
<p>Document sample_restraint package. Reference issue
<a class="reference external" href="https://redmine.gromacs.org/issues/3027">3027</a></p>
</div>
</div>
</div>
<div class="section" id="troubleshooting">
<h2><a class="toc-backref" href="#id22">Troubleshooting</a><a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<p>Couldn’t find the <code class="docutils literal notranslate"><span class="pre">gmxapi</span></code> support library?
If you don’t want to “source” your <code class="docutils literal notranslate"><span class="pre">GMXRC</span></code> file, you
can tell the package where to find a gmxapi compatible GROMACS installation with
<code class="docutils literal notranslate"><span class="pre">gmxapi_DIR</span></code>. E.g. <code class="docutils literal notranslate"><span class="pre">gmxapi_DIR=/path/to/gromacs</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">.</span></code></p>
<p>Before updating the <code class="docutils literal notranslate"><span class="pre">gmxapi</span></code> package it is generally a good idea to remove the
previous installation and to start with a fresh build directory. You should be
able to just <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">uninstall</span> <span class="pre">gmxapi</span></code>.</p>
<p>Do you see something like the following?</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CMake Error at gmx/core/CMakeLists.txt:45 (find_package):
   Could not find a package configuration file provided by &quot;gmxapi&quot; with any
   of the following names:

     gmxapiConfig.cmake
     gmxapi-config.cmake

   Add the installation prefix of &quot;gmxapi&quot; to CMAKE_PREFIX_PATH or set
   &quot;gmxapi_DIR&quot; to a directory containing one of the above files.  If &quot;gmxapi&quot;
   provides a separate development package or SDK, be sure it has been
   installed.
</pre></div>
</div>
<p>This could be because</p>
<ul class="simple">
<li><p>GROMACS is not already installed</p></li>
<li><p>GROMACS was built without the CMake variable <code class="docutils literal notranslate"><span class="pre">GMXAPI=ON</span></code></p></li>
<li><p>or if <code class="docutils literal notranslate"><span class="pre">gmxapi_DIR</span></code> (or <code class="docutils literal notranslate"><span class="pre">GROMACS_DIR</span></code>) is not a path containing directories
like <code class="docutils literal notranslate"><span class="pre">bin</span></code> and <code class="docutils literal notranslate"><span class="pre">share</span></code>.</p></li>
</ul>
<p>If you are not a system administrator you are encouraged to install in a Python
virtual environment, created with virtualenv or Conda.
Otherwise, you will need to specify the <code class="docutils literal notranslate"><span class="pre">--user</span></code> flag to <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<p>Two of the easiest problems to run into are incompatible compilers and
incompatible Python. Try to make sure that you use the same C and C++
compilers for GROMACS, for the Python package, and for the sample
plugin. These compilers should also correspond to the <code class="docutils literal notranslate"><span class="pre">mpicc</span></code> compiler
wrapper used to compile <code class="docutils literal notranslate"><span class="pre">mpi4py</span></code>. In order to build the Python
package, you will need the Python headers or development installation,
which might not already be installed on the machine you are using. (If
not, then you will get an error about missing <code class="docutils literal notranslate"><span class="pre">Python.h</span></code> at some
point.) If you have multiple Python installations (or modules available
on an HPC system), you could try one of the other Python installations,
or you or a system administrator could install an appropriate Python dev
package. Alternatively, you might try installing your own Anaconda or
MiniConda in your home directory.</p>
<p>If an attempted installation fails with CMake errors about missing
“gmxapi”, make sure that Gromacs is installed and can be found during
installation. For instance,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">gmxapi_DIR</span><span class="o">=</span>/Users/eric/gromacs python setup.py install --verbose
</pre></div>
</div>
<p>Pip and related Python package management tools can be a little too
flexible and ambiguous sometimes. If things get really messed up, try
explicitly uninstalling the <code class="docutils literal notranslate"><span class="pre">gmxapi</span></code> module and its dependencies, then do
it again and repeat until <code class="docutils literal notranslate"><span class="pre">pip</span></code> can no longer find any version of any
of the packages.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip uninstall gmxapi
pip uninstall cmake
<span class="c1"># ...</span>
</pre></div>
</div>
<p>Successfully running the test suite is not essential to having a working
<code class="docutils literal notranslate"><span class="pre">gmxapi</span></code> package. We are working to make the testing more robust, but
right now the test suite is a bit delicate and may not work right, even
though you have a successfully built <code class="docutils literal notranslate"><span class="pre">gmxapi</span></code> package. If you want to
troubleshoot, though, the main problems seem to be that automatic
installation of required python packages may not work (requiring manual
installations, such as with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">somepackage</span></code>) and ambiguities
between python versions.</p>
<p>If you are working in a development branch of the repository, note that
the upstream branch may be reset to <code class="docutils literal notranslate"><span class="pre">master</span></code> after a new release is
tagged. In general, but particularly on the <code class="docutils literal notranslate"><span class="pre">devel</span></code> branch, when you
do a <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code>, you should use the <code class="docutils literal notranslate"><span class="pre">--rebase</span></code> flag.</p>
<p>If you fetch this repository and then see a git status like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git status
On branch devel
Your branch and <span class="s1">&#39;origin/devel&#39;</span> have diverged,
and have <span class="m">31</span> and <span class="m">29</span> different commits each, respectively.
</pre></div>
</div>
<p>then <code class="docutils literal notranslate"><span class="pre">gmxapi</span></code> has probably entered a new development cycle. You can
do <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span> <span class="pre">--rebase</span></code> to update to the latest development branch.</p>
<p>If you do a <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code> while in <code class="docutils literal notranslate"><span class="pre">devel</span></code> and get a bunch of unexpected
merge conflicts, do <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span> <span class="pre">--abort;</span> <span class="pre">git</span> <span class="pre">pull</span> <span class="pre">--rebase</span></code> and you should
be back on track.</p>
<p>If you are developing code for gmxapi, this should be an indication to
rebase your feature branches for the new development cycle.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Full installation instructions</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a><ul>
<li><a class="reference internal" href="#build-system-requirements">Build system requirements</a></li>
<li><a class="reference internal" href="#python-environment-requirements">Python environment requirements</a><ul>
<li><a class="reference internal" href="#requirements-files-in-gromacs-source-tree">“requirements” files in GROMACS source tree</a></li>
</ul>
</li>
<li><a class="reference internal" href="#documentation-build-requirements">Documentation build requirements</a></li>
<li><a class="reference internal" href="#testing-requirements">Testing requirements</a></li>
<li><a class="reference internal" href="#mpi-requirements">MPI requirements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installing-the-python-package">Installing the Python package</a><ul>
<li><a class="reference internal" href="#recommended-installation">Recommended installation</a><ul>
<li><a class="reference internal" href="#locate-or-install-gromacs">Locate or install GROMACS</a></li>
<li><a class="reference internal" href="#set-up-a-python-virtual-environment">Set up a Python virtual environment</a></li>
<li><a class="reference internal" href="#install-dependencies">Install dependencies</a></li>
<li><a class="reference internal" href="#install-the-latest-version-of-gmxapi">Install the latest version of gmxapi</a><ul>
<li><a class="reference internal" href="#gmxapi-dir">gmxapi_DIR</a></li>
<li><a class="reference internal" href="#gmxtoolchaindir">GMXTOOLCHAINDIR</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#install-from-source">Install from source</a></li>
<li><a class="reference internal" href="#offline-install">Offline install</a></li>
<li><a class="reference internal" href="#building-a-source-archive">Building a source archive</a></li>
</ul>
</li>
<li><a class="reference internal" href="#accessing-gmxapi-documentation">Accessing gmxapi documentation</a><ul>
<li><a class="reference internal" href="#build-with-gromacs">Build with GROMACS</a></li>
<li><a class="reference internal" href="#docker-web-server">Docker web server</a></li>
</ul>
</li>
<li><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="userguide.html"
                        title="previous chapter">Python User Guide</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="usage.html"
                        title="next chapter">Using the Python package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/userguide/install.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Using the Python package"
             >next</a> |</li>
        <li class="right" >
          <a href="userguide.html" title="Python User Guide"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">gmxapi</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="userguide.html" >Python User Guide</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, M. Eric Irrgang and Peter Kasson; 2019, GROMACS development team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.2.
    </div>
  </body>
</html>