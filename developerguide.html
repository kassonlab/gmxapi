

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Architecture and design notes &mdash; Gromacs External Interfaces</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Gromacs External Interfaces" href="index.html"/>
        <link rel="next" title="Components" href="components.html"/>
        <link rel="prev" title="Guides" href="userguide.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Gromacs API
          

          
          </a>

          
            
            
              <div class="version">
                0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation sections</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide.html">Guides</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Architecture and design notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#principles">Principles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#performance-versus-flexibility">Performance versus Flexibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api-data-ownership">API data ownership</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optimize-tool-chaining-within-the-gromacs-framework">Optimize tool chaining within the Gromacs framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="#catch-errors-early">Catch errors early</a></li>
<li class="toctree-l3"><a class="reference internal" href="#protocols-and-interfaces">Protocols and Interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#this-is-not-a-port-or-a-wrapper">This is not a port or a wrapper</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#required-or-included-software">Required or included software</a></li>
<li class="toctree-l2"><a class="reference internal" href="#validation-and-verifiability">Validation and verifiability</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="components.html">Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="layers.html">Implementation layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Gromacs API</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Architecture and design notes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/developerguide.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="architecture-and-design-notes">
<h1>Architecture and design notes<a class="headerlink" href="#architecture-and-design-notes" title="Permalink to this headline">¶</a></h1>
<p>Principles, requirements, and guidelines.</p>
<div class="section" id="principles">
<h2>Principles<a class="headerlink" href="#principles" title="Permalink to this headline">¶</a></h2>
<div class="section" id="performance-versus-flexibility">
<h3>Performance versus Flexibility<a class="headerlink" href="#performance-versus-flexibility" title="Permalink to this headline">¶</a></h3>
<p>Make it easy for the user to do efficient operations with data and constructs owned by the framework; make it easy but transparent and explicit when the user performs flexible but less efficient operations moving data between Gromacs ownership and external ownership.</p>
</div>
<div class="section" id="api-data-ownership">
<h3>API data ownership<a class="headerlink" href="#api-data-ownership" title="Permalink to this headline">¶</a></h3>
<p>Crossing the boundary of data ownership by the framework versus the user interface should be explicit.</p>
<p>As a consequence of the above, data &#8220;owned&#8221; by the graph of gmx modules can be optimized for performance and minimal communication. Crossing that boundary by getting data to and from the python interpreter should be explicit. Implicit casting of data to GMX objects should not be performed if it crosses this boundary. Fetching data should require an explicit and syntactically distinct accessor method.</p>
</div>
<div class="section" id="optimize-tool-chaining-within-the-gromacs-framework">
<h3>Optimize tool chaining within the Gromacs framework<a class="headerlink" href="#optimize-tool-chaining-within-the-gromacs-framework" title="Permalink to this headline">¶</a></h3>
<p>Similarly (and motivated by some of the explicit data movement patterns above), we will want to expose some primitives for variables under Gromacs management (simple array operations) as well as simplify and modularize some common operations performed in analysis workflows between Gromacs tasks.  If the common usage is GMX.operationA -&gt; X -&gt; GMX.operationB and X is common or sufficiently simple, then it should be possible to do X in the GMX framework.  If X does not occur between two GMX operations, X is highly complex, and/or X is not commonly used, then the case for management by the GMX framework as opposed to external code is less strong.</p>
</div>
<div class="section" id="catch-errors-early">
<h3>Catch errors early<a class="headerlink" href="#catch-errors-early" title="Permalink to this headline">¶</a></h3>
<p>Gromacs tools are often structured the way they are so that the user has the
chance to get errors before submitting a job to a queue or using resources.
We should keep this in mind. To every extent possible, we should make sure that
the runner will not fail due to configuration errors when it is ready to schedule
work.</p>
</div>
<div class="section" id="protocols-and-interfaces">
<h3>Protocols and Interfaces<a class="headerlink" href="#protocols-and-interfaces" title="Permalink to this headline">¶</a></h3>
<p>The API must be sufficiently
self-documenting to facilitate correct use <em>and</em> extension. Required behavior
of clients and derived classes, and expected behavior of API objects, must be
clear for stateful interfaces, <em>e.g.</em> protocols requiring a sequence of multiple
API calls or API calls with side effects. To help ensure that documented design
matches actual behavior, design documentation should be embedded in and extracted
from the implementation, tagged with API version metadata, and verified with regression tests.</p>
</div>
<div class="section" id="this-is-not-a-port-or-a-wrapper">
<h3>This is not a port or a wrapper<a class="headerlink" href="#this-is-not-a-port-or-a-wrapper" title="Permalink to this headline">¶</a></h3>
<p>Don&#8217;t expose old cruft and unnecessary functionality.</p>
<p>One example that comes up repeatedly: aspects of pdb2gmx and trajconv only exist for historic reasons and need not be exposed, duplicated, or preserved. Other aspects should be discrete API calls. We should maintain an eye for tasks better provided by other tools and aim for interoperability. We should provide an easy and well-documented mechanism for bringing outside tools into the Gromacs environment where appropriate for performance. I.e. there may be a gmx.analysis.map() mechanism or some such to apply arbitrary computation under the management of Gromacs workflow and (parallel) resource management.</p>
<p>High level tools and convenience APIs are to be built on a C++ API accessible
from outside of the core library. This public API is built with the library at a
lower level than any UI-aware code. This requires reworking aspects of the library
API in ways that are also helpful to the maintenance of current code and tools.</p>
<p>While CLI and API use cases are distinct, CLI tools should be implemented at the
highest possible layer to ensure uniform semantics and maintainability for common
functionality. Many current tools have CLI or terminal-centric implementation at
a low level. Adding public API functionality is an opportunity to refactor such
tools, but some fundamental idioms will need to be revisited, such as interactive
options refinement.</p>
</div>
</div>
<div class="section" id="required-or-included-software">
<h2>Required or included software<a class="headerlink" href="#required-or-included-software" title="Permalink to this headline">¶</a></h2>
<p>Suggestions:</p>
<ul class="simple">
<li>Python &gt;= 3.4</li>
<li>pybind11</li>
<li>Eigen</li>
</ul>
</div>
<div class="section" id="validation-and-verifiability">
<h2>Validation and verifiability<a class="headerlink" href="#validation-and-verifiability" title="Permalink to this headline">¶</a></h2>
<p>The Gromacs project rightly emphasizes the reproducibility of scientific results
and the ability to guarantee that simulation results can be tied to a known,
validated software set. These priorities are reflected in design decisions and
cultivated paradigms related to the simulation input and output files.</p>
<p>This documentation discusses what records and
bookkeeping exist in API-driven Gromacs use to accomodate this scientific due
diligence.</p>
<p>Specifically, what is the role of the content of a script, itself? What is
sufficient to describe for posterity the parameters of a specific set of output?
What discussion, documentation, clarification, etc, if any, needs to happen
regarding mutable input parameters, as in ensemble simulations or adaptive
workflows? Is there a canonical way to record parameters necessary for
reproducibility or simply a set of conventions or standards? If there is not a
canonical representation (e.g. TPR file), how and to what degree are tools
implemented for automated sanity checking, etc.?</p>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<p>Simulation output should be clearly mapped to the inputs and code that produced
it.</p>
<p>Model, protocol, and method should be easily and concisely captured for
reproducibility of published (publishable) work.</p>
<p>There should be no additional ambiguity introduced by API use. E.g. The meaning
and implications of a TPR file should not change, or should only change as a
result of the broader Gromacs roadmap.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="components.html" class="btn btn-neutral float-right" title="Components" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="userguide.html" class="btn btn-neutral" title="Guides" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, M. Eric Irrgang and Peter Kasson.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>